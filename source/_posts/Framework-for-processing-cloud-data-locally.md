---
title: Framework for processing cloud data locally
subtitle: Lorem Ipsum SubTitle
description: '#used in meta tags'
comments: false
toc: true
cover_index: //placehold.it/450.jpg/dddddd/333333
cover_detail: //placehold.it/1000x450.jpg/dddddd/333333
tags:
  - design
  - strategy
  - process
  - data
categories:
  - categ1
share:
  twitter: I found a new post from EricDMoore called
  facebook: I found a new post from EricDMoore called
  message: I found a new post from EricDMoore called
date: 2019-10-23T13:35:08.000Z
---

# TLDR;

Cloud systems are great at collecting events. But processing those events can get expensive for side projects. So can we create a means where the data can be sent to something I have already paid for - say my raspberry pi bramble? <!-- more -->

# Table of Contents

# Definitions

Let's start with some _Definitions_ and _First Principles_:

1. "Locally" - I mean on hardware that I own, or can at least can touch and see, and can hopefully control with some certainty.
2. "The Cloud" - I mean some computing substrate somewhere in the world not owned or touchable by be

# First Principles

1. "The Cloud" is always•• on. My laptop, raspberrypi, or phone is not.
2. "The Cloud" can QUICKLY generate way more data than I may ever have a chance of processing.
3. "The Cloud" is very good at allowing utility pricing, but terrible a permitting utility-company style capacity planning. "The Cloud" is elastic got it; we can stretch out work over lots of resources. But consider the original utilities - power plants: the cloud represents a bunch of expensive generators that can be brought online to handle lots of work. However, usually a utility company will setup some highly efficient (aka: cheap to operate) baseline systems that are always running. Baseline systems cheaply handle all the work that never goes away. Or said differently, the handle completing work at the same rate that new work shows up.
4. "The Data" generated by "The Clould" ideally should not care if its processed in the cloud or on my hardware. Not to say from micro-chip architecture perspective PowerPC, ARM, or x86 architectures though that should be given consideration, but from latency and merging of data streams capabilities. If the baseline processing is a slow but cheap information highway, and new, fast, and expensive highways can be created as needed when traffic builds. It would be nice if the order in which the processed data arrives would be inconsequential to outside systems. Meaning, that could be merely an intenral detail of cost opimization that neighboring system would not know. Just like I don't know when, nor do I care when a power plant fires up expensive generators; I just care that the lights turn on. If you want to throw around a $7 words it would be nice if the base-line data processed was an `idempotent monoid`.

So with these guidelines what are my options?

# Options

Each option should be weight by the the cost it adds, and the operational complexity it adds whether that be provisioning and scaling the baseline processors, or dealing with long tail failure modes that happen enough to prevent or catch things during some bad applciation state.

## Evalutaion Criterion

- Costs
- Setup Time
- Latency (@90p, @99p, and @99.9p)
- Throughput (@90p, @99p, and @99.9p)
- Application Complexity required to deal with spliced data steams

Assume data is coming from some an AWS Cloud serverless environment or AutoScaling Group on EC2 - please map these over to Google, or Azure equivalents.

Assume you have a RaspberryPi Bramble (cluster or raspberrys) that sits in your office or home office.

### 1\. Direct Connect

The naieve approach is to have your cloud compute hand off the processing to your local bramble, sitting under your desk. Easy enough lets just setup an http server, zmq bound socket, or gRPC and let it listen on a socket. you would just run a `js.fetch("http://mydomain.com")`. GREAT! DONE. now the processing happens on the baseline, be sure to not wait for the completion of the response.

#### Problems:

1. You can't figure out how to, or IT wont let you accept traffic from outside the network. (sometiumes reffered to as poking a hole in your firewall)
2. You can easily DOS your bramble, such that it can't keep up. So you will need someway of knowing that the bramble is overloaded.

#### Intermediate Solutions:

1. If you work with a formal IT group good luck. Number 1 has no good answers. Even if you are talking about your bramble at home under your couch, and you can configure your router and such. You will need to make sure you have a static IP, and not a DHCP address from your ISP. If that means nothing to you, them just hear it as more reasons wby even when you think you escape #1 it comes back to bite you.
2. This is really the problem of back-pressure. The best solution here is to respond BEFORE you compelte anywork with some indicitation of your workload. Say the first thing you do on the bramble is save the data to a folder on the filesystem, and once you process the answer from the data input, you push it back to the cloud, and maybe save a copy in a different folder on the file system. You might reply with how many files you have left to process, BEFORE you start processing anything. Using the fs has some trade offs but for sake of a very cheap easy to understand system... its a reaonable example.

### 2\. Stable Middle Ground Connector

The second approach you might consodier is keeping one stable bastion host. With its stable IP, or at least stable DNS, you add some software to monitor connections on it. And when your bramble is online, it connects to the bastion with XMPP, zmq, or similar and can get data routed to it via the bastion.

#### Problems:

1. If your baseline is sufficiently large or small and growing, you will (eventiually) have multiple brambles connecting to this bastion box, or will need some collection of bastions. To deal with the many connections

#### Intermediate Solutions:

1. Having an auto-scalling bastion group seems antithetical to my purposes. I suppose it is a perfectly valid, solution for large enterprises, but it feels like a bazooka or worse (a foothgun) to me at first blush. I hope to discredit this solution catagory via the pricing criterion.

### 3\. Persistent Data Queue

Lastly, having seen how nice it is conceptually to be able to count on a resource being there, for when ever the bramble can actively process things, we come to the category of thigns like SQS, or other persisted queues/data steams.

#### SQS Powered

I would likely setup it up like this:

![SQS Flowchart](/charts/groundcomputeOpts/groundCompute-sqs.mmd.svg)

- SNS in front because its free, performant, and privide extra optionality for future growth.
- SQS as a persistent and durable data holder
- SNS for data coming back in

#### Problems

1. Cloud Vendor Lock in

### Intermediate Solutions

1. My gut here is that this a reasonable price to pay to manage costs, and innovate on the problem I want to solve - which does not include RAID configurations to minimize data loss in failure modes, etc.

#### Kinesis Firehose

I would likely setup it up like this: Application has Data in the Outbox then:

![Firehose Flowchart](/charts/groundcomputeOpts/groundCompute-fh.mmd.svg)

The Bramble could poll the S3 bucket via Athena, or via using the timestamps, and keep a small bit of state as the last processed

{% imageGrid cols=4 %} //via.placeholder.com/350.jpg/dddddd/333333 //via.placeholder.com/350.jpg/333333/dddddd //via.placeholder.com/350.jpg/dddddd/333333 //via.placeholder.com/350.jpg/333333/dddddd {% endimageGrid %}

Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nullam et ultrices nulla, vel porttitor urna. Maecenas volutpat dolor a est condimentum dictum. Pellentesque arcu nibh, lobortis tincidunt elit sit amet, pharetra faucibus turpis. Morbi interdum, felis non vestibulum fermentum, quam justo tincidunt mauris, at dictum orci leo eget urna. Integer ornare justo vel sodales porttitor. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed a mollis odio. Praesent turpis neque, congue ut odio eu, finibus viverra tellus.

**References:**

- google.com

**Footnotes**

- •• = "The Cloud" is merely someone elses computer somewhere else where I repeatedly pay to access it. So yes, sometimes but very infrequently it is not accessible.
